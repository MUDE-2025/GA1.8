# Report


## Part 1

**1. Describe your chosen initial values for the Gauss-Newton iteration and reflect on how your choice of initial values for the Gauss-Newton iteration influenced the convergence of your solution. What did you observe about the number of iterations needed and the stability of the estimated parameters when using different initial values? After how many iterations does it converge? (2pt)**
_To include in your answer:_  
- A plot of your estimates for each parameter versus the iteration number (horizontal axis: iteration number, vertical axis: parameter estimate)



**a. Initial Values for Gauss-Newton Iteration**

- $d_0 = 10.099$ m (approximate initial offset)
- $v = 0.35$ m (estimated total uplift over the period)
- $a = 80$ days (system memory, tuned to fit the curve)
- $A = 0.05$ m (seasonal amplitude)

- For $d_0$ and $A$ you could use the estimated values from the linear model, but they do not work very well because their estimators are biased with the linear model.
    
- For $v$: realize that it is the difference between displacement at start and end of the observation interval (look at plot with data).
    
- For $a$: you could plot the curve with initial values and try different values of $a$ to see which one would fit the observations well here.

**Parameter Convergence Plots**

*(Insert the four plots generated by `plot_fit_iteration(xhat_i_gnss)`*

---


**b. Reflection on Initial Values and Convergence**

The choice of initial values significantly influenced the convergence behavior. When initial values were close to the true values, the algorithm converged quickly and the parameter estimates were stable. If initial values were chosen further from the true solution, more iterations were needed, and in some cases, the algorithm could fail to converge or converge to incorrect values. This highlights the importance of informed initial guesses in non-linear least squares problems.



1a.
- 0.5 points Describing initial parameters
- 0.5 points For showing iterations needed (with visual)

1b.
- 1.0 points Reflecting on the significance of the initial value 

(in all cases half of the points can be subtracted if only partially correct) 


## Part 2

**2. Analysis the fitted model and residuals, do you think the initial fitted model is correct? Is the initial hypothesis accepted or rejected? (2 pt)**  
_To include in your answer:_    
- Whether the distribution of the residuals is as expected, and why or why not   
- The outcome of the overall model test  
- How would the critical value need to change in order to accept the null hypothesis $H_0$?


**a) Analysis of the Fitted Model and Residuals**

The mean and standard deviations are as expected given the assumed observation precision of 15 mm. However, the residual plot shows a discontinuity around July 2024, which leads to deviations in the upper tail of the residual distribution. As a result, some residuals are larger than expected, and the upper quantiles (outliers) do not follow the expected normal distribution. This suggests that the model does not fully capture all systematic effects in the data.

**b) Overall Model Test:**  
The test statistic is 440.46, while the critical threshold is 406.30. Since the test statistic exceeds the threshold, we reject the null hypothesis $H_0$. This means the fitted model does not fully explain the data.

**c) Critical Value for $H_0$ Acceptance:**  
To accept the null hypothesis $H_0$, the critical value would need to be increased above the observed test statistic (i.e., above 440.46). However, changing the critical value should only be done with a justified reason, such as a different significance level.



2a.
- 0.5 pt — Correctly assessing and explaining whether the distribution of the residuals is as expected, with clear reasoning

2b.
- 1.0 pt — Correctly stating and interpreting the outcome of the overall model test (including correct use of test statistic and threshold, and what it means for $H_0$)

2c. 
- 0.5 pt — Correctly explaining how the critical value would need to change in order to accept $H_0$, and what this implies

(in all cases half of the points can be subtracted if only partially correct) 



## Part 3
**4. For the alternative model using the Generalized Likelihood Ratio Test (GLRT), estimate the most likely day the shift occurred. Identify the day $\mathbf{k}_{\text{hat}}$ corresponding to the maximum test statistic and report this estimated day of shift. Is the alternative hypothesis accepted or rejected?(2 pt)**


**a) GLRT and Estimation of Shift Day**

The Generalized Likelihood Ratio Test (GLRT) was applied to the data to detect the most likely day of the shift. For each possible day $k$, the model was fitted and the test statistic was computed. The day with the maximum test statistic corresponds to the most likely shift.

- The estimated day of the shift is $\mathbf{k}_{\text{hat}} = 199$, where the test statistic reaches its maximum value of 102.88. (Note: In an earlier version of this assignment the test statistic was 102.70)

**b) overall Model Test:**  
The test statistic is 337.58, while the critical threshold is 405.24. Since the test statistic is below the threshold, we accept the null hypothesis $H_0$ for the alternative model. This means the alternative model provides a statistically adequate fit to the data.



3a
- 1.0 pt — Correctly applying the GLRT, identifying and reporting the estimated day of shift ($\mathbf{k}_{\text{hat}}$) and the corresponding test statistic.

3b
- 1.0 pt — Correctly stating and interpreting the outcome of the overall model test (including correct use of test statistic and threshold, and what it means for $H_0$).

(in all cases half of the points can be subtracted if only partially correct) 



## Part 4

**6. Compare the final, selected model against the initial model in terms of estimated parameters, overall model fit and residual statistics. Explain in detail why it is essential to rely on the statistical tests rather than solely on visual inspection, especially when the simpler model might appear "good enough" when simply plotted against the observations. (3pt)**
_To include in your answer:_ 
- Your estimated parameters from $H_0$ and $H_a$ and their quality 


**a) Estimated Parameters and their Quality and Convergence for $H_0$ and $H_a$**

The Gauss-Newton iteration was applied using these initial values. The algorithm converged after **for example 7 iterations**. The final estimated parameters are:
- $d_0 = 10.009$ m
- $v = 0.355$ m
- $a = 127.644$ days
- $A = 0.028$ m

The standard deviation for offset ($d_0$) is 0.0054 m
The standard deviation for $v$ is 0.0033 m/day
The standard deviation for scaling parameter $a$ is 6.1123 days
The standard deviation for amplitude ($A$) is 0.002 m


Using the alternative model with the shift at day 199, the Gauss-Newton iteration converged after 6 iterations. The estimated parameters are:
- $d_0 = 10.005$ m
- $v = 0.311$ m
- $a = 99.242$ days
- $A = 0.030$ m
- $s = 0.030 $ m

The standard deviation for $d_0$ is 0.0052 m
The standard deviation for $v$ is 0.0061 m/day
The standard deviation for $a$ is 4.9080 days
The standard deviation for $A$ is 0.0017 m
The standard deviation for $s$ is 0.0036 m

These results indicate that the model with a shift at day 199 provides a better fit to the data, as supported by the GLRT.

Old version had slightly different numbers. Depending on jacobian based on code implementation or text notation, the following numbers were found:

Final GNSS parameter estimates:
d_0 = 10.002 m
v   = 0.304 m/day
a   = 93.383 days
A   = 0.029 m
shift = 0.037 m
Change point at day k = 199

Final standard deviations of estimated parameters (GNSS with shift):
d_0 = 0.0051 m
v   = 0.0059 m/day
a   = 4.5682 days
A   = 0.0017 m
shift = 0.0036 m

The estimated time of the shift is day 199, with test statistic 102.70.
Test statistic is 337.76, threshold is 405.24.

Final GNSS parameter estimates:
d_0 = 10.002 m
v   = 0.304 m/day
a   = 93.371 days
A   = 0.029 m
shift = 0.037 m
Change point at day k = 199

Final standard deviations of estimated parameters (GNSS with shift):
d_0 = 0.0052 m
v   = 0.0059 m/day
a   = 4.5886 days
A   = 0.0017 m
shift = 0.0036 m


**Comparison**

- Less residuals are outside the confidence interval.
- The residuals for the alternative model have a smaller standard deviation and their distribution more closely matches a normal distribution, as confirmed by the Q-Q plot and histogram.
- The value of the estimated $a$ changes from around 130 to 99, which shows how the mismodelling can affect the parameter estimation. This can be very important in case the model is used for predicting the displacements for the future!
- The introduction of the shift parameter $s$ captures the abrupt change in displacement, which was not explained by the initial model.


**c) Importance of statistical tests**
- Visual inspection alone can be misleading because the human eye may not detect subtle but statistically significant deviations, outliers, or patterns in the residuals.
- A model might appear to fit the data well when plotted, but statistical tests provide objective criteria to assess model adequacy, parameter reliability, and the presence of systematic errors.
- Statistical tests quantify the likelihood that observed deviations are due to random noise rather than model misspecification.
- Ignoring statistical tests risks accepting a model that does not truly capture the underlying process, which can lead to biased or imprecise parameter estimates.
- This is especially important for parameters like $a$, where mismodelling can result in significant errors in future predictions.


4a
- 0.5 pt - Showing estimated parameters from $H_0$ and $H_a$ and their quality. 
- 0.5 pt - Discussing differences in estimated parameters   

4b.
- 1.0 pt — Correctly comparing the final selected model and the initial model in terms of overall model fit and residual statistics (e.g., fewer residuals outside the confidence interval, smaller standard deviation, better fit to normal distribution).

4c
- 1.0 pt — Clearly explaining why it is essential to rely on statistical tests rather than only visual inspection, including the impact on parameter estimation and the importance for future predictions. (not all bullet points in solution need to be mentioned, but at least what is mentioned here in the rubric)

(in all cases half of the points can be subtracted if only partially correct) 




> By Sandra Verhagen and Lina Hagenah, Delft University of Technology. CC BY 4.0, more info [on the Credits page of Workbook](https://mude.citg.tudelft.nl/workbook-2025/credits.html).